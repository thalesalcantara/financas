<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Login - Kratos System</title>
<link rel="icon" href="/static/logo.png" type="image/png" />
<style>
  body {
    margin:0; padding:0; min-height:100vh;
    display:flex; align-items:center; justify-content:center;
    background:#232a39; color:#e6eefc;
    font-family: 'Segoe UI', Arial, sans-serif;
  }
  .auth-card {
    background:#222b44;
    padding:2rem;
    border-radius:1rem;
    width:320px;
    box-shadow:0 8px 32px #0002;
    display:flex; flex-direction:column; align-items:center;
  }
  .auth-card img {
    width:64px; margin-bottom:1rem;
  }
  h2 {
    margin-bottom:1rem;
  }
  form {
    width:100%;
  }
  label {
    display:block;
    margin-bottom:1rem;
  }
  input[type="text"], input[type="password"] {
    width:100%;
    padding:0.5rem;
    border-radius:0.5rem;
    border:1px solid #2b3552;
    background:#171f2e;
    color:#e6eefc;
    font-size:1rem;
  }
  button {
    width:100%;
    padding:0.6rem;
    border:none;
    border-radius:1rem;
    background:#163772;
    color:white;
    font-size:1.1rem;
    cursor:pointer;
  }
  .alt-link {
    margin-top:1rem;
    color:#24c176;
    cursor:pointer;
    text-align:center;
    text-decoration:underline;
  }
  small {
    display:block;
    margin-top:1rem;
    color:#aaa;
    text-align:center;
  }
</style>
</head>
<body>
  <div class="auth-card" id="authCard">
    <img src="/static/logo.png" alt="Logo Kratos" />
    <h2>Kratos System</h2>
    <form id="loginForm">
      <label>
        Email:
        <input type="text" id="loginEmail" required autocomplete="username" />
      </label>
      <label>
        Senha:
        <input type="password" id="loginSenha" required autocomplete="current-password" />
      </label>
      <button type="submit">Entrar</button>
    </form>
    <div class="alt-link" id="showRegister">Cadastrar nova conta</div>
    <small>Seus dados ficam protegidos na nuvem com Firebase</small>
  </div>

<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
<script>
  // Configuração do Firebase para o projeto kratosfinancas
  const firebaseConfig = {
    apiKey: "AIzaSyD32JNIb-IplbuAM8WD-Nw_P3gA5wNSNwY",
    authDomain: "kratosfinancas.firebaseapp.com",
    projectId: "kratosfinancas",
    storageBucket: "kratosfinancas.firebasestorage.app",
    messagingSenderId: "740158664268",
    appId: "1:740158664268:web:9e4583e75c94cbd90c0ee9"
  };

  // Inicializa o Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const authCard = document.getElementById('authCard');

  function renderRegister() {
    authCard.innerHTML = `
      <img src="/static/logo.png" alt="Logo Kratos" />
      <h2>Nova Conta</h2>
      <form id="registerForm">
        <label>
          Email:
          <input type="text" id="regEmail" required autocomplete="username" />
        </label>
        <label>
          Senha:
          <input type="password" id="regSenha" required autocomplete="new-password" />
        </label>
        <button type="submit">Cadastrar</button>
      </form>
      <div class="alt-link" id="showLogin">Já tem conta? Entrar</div>
    `;

    document.getElementById('registerForm').onsubmit = e => {
      e.preventDefault();
      const email = document.getElementById('regEmail').value.trim();
      const senha = document.getElementById('regSenha').value;
      auth.createUserWithEmailAndPassword(email, senha)
        .then(() => {
          alert("Cadastro realizado com sucesso! Faça login.");
          renderLogin();
        })
        .catch(err => alert("Erro: " + (err.message || err)));
    };

    document.getElementById('showLogin').onclick = renderLogin;
  }

  function renderLogin() {
    authCard.innerHTML = `
      <img src="/static/logo.png" alt="Logo Kratos" />
      <h2>Kratos System</h2>
      <form id="loginForm">
        <label>
          Email:
          <input type="text" id="loginEmail" required autocomplete="username" />
        </label>
        <label>
          Senha:
          <input type="password" id="loginSenha" required autocomplete="current-password" />
        </label>
        <button type="submit">Entrar</button>
      </form>
      <div class="alt-link" id="showRegister">Cadastrar nova conta</div>
      <small>Seus dados ficam protegidos na nuvem com Firebase</small>
    `;

    document.getElementById('loginForm').onsubmit = e => {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value.trim();
      const senha = document.getElementById('loginSenha').value;
      auth.signInWithEmailAndPassword(email, senha)
        .then(() => {
          window.location.href = "app.html";
        })
        .catch(err => alert("Erro: " + (err.message || err)));
    };

    document.getElementById('showRegister').onclick = renderRegister;
  }

  // Inicializa mostrando o formulário de login
  renderLogin();
</script>
</body>
</html>
